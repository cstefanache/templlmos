<html>
 <head>
  <style id="osbase_general-styles">
   body {
    background-color: #ffe4e1; /* This is a light pink color */
    overflow: hidden; /* This will hide any content that goes beyond the visible area */
}
  </style>
  <script id="osbase_global-objects">
   (() => {
window.os = {};


})()
  </script>
  <script id="osbase_filesystem">
   (() => {
// Load filesystem object from local storage if it exists
let filesystem = JSON.parse(localStorage.getItem('filesystem')) || {};

// Define window.os.fs object
if (!window.os) { window.os = {}; }
if (!window.os.fs) { window.os.fs = {}; }

// Define sync function
window.os.fs.sync = function() {
    localStorage.setItem('filesystem', JSON.stringify(filesystem));
}

// Define readPath function
window.os.fs.readPath = function(path) {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let pathArray = path.split('/');
    let current = filesystem;
    for (let i = 0; i < pathArray.length; i++) {
        if (current[pathArray[i]] === undefined) { return undefined; } // path not found
        current = current[pathArray[i]];
    }
    return current;
}

// Define write function
window.os.fs.write = function(path, content) {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let pathArray = path.split('/');
    let current = filesystem;
    for (let i = 0; i < pathArray.length - 1; i++) { // skip last element (file name)
        if (current[pathArray[i]] === undefined) { current[pathArray[i]] = {}; } // create path if it doesn't exist
        current = current[pathArray[i]];
    }
    current[pathArray[pathArray.length - 1]] = content; // set content of file at path
    this.sync(); // save changes to filesystem
}

// Define ls function
window.os.fs.ls = function(path = '') {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let current = this.readPath(path) || filesystem; // get directory at path or root if path is empty or not found
    return Object.keys(current); // return list of entries in directory
}

// Define mkdir function
window.os.fs.mkdir = function(path) {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let pathArray = path.split('/');
    let current = filesystem;
    for (let i = 0; i < pathArray.length - 1; i++) { // skip last element (directory name)
        if (current[pathArray[i]] === undefined) { current[pathArray[i]] = {}; } // create path if it doesn't exist
        current = current[pathArray[i]];
    }
    current[pathArray[pathArray.length - 1]] = {}; // create directory at path
    this.sync(); // save changes to filesystem
}

// Define rm function
window.os.fs.rm = function(path) {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let pathArray = path.split('/');
    let current = filesystem;
    for (let i = 0; i < pathArray.length - 1; i++) { // skip last element (file name)
        if (current[pathArray[i]] === undefined) { return; } // path not found
        current = current[pathArray[i]];
    }
    delete current[pathArray[pathArray.length - 1]]; // remove file at path
    this.sync(); // save changes to filesystem
}

// Define isFile function
window.os.fs.isFile = function(path) {
    if (path[0] === '/') { path = path.substring(1); } // remove leading '/' if exists
    let value = this.readPath(path); // get value at path
    return typeof value === 'string'; // return true if value is string (file)
}


})()
  </script>
  <style id="desktop_content-style">
   #desktop_content {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow-y: hidden;
    padding: 10px;
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-content: flex-start;
}
  </style>
  <style id="desktop_styles">
   .icon {
    width: 64px;
    min-height: 64px;
    text-align: center;
    margin: 5px;
    cursor: pointer;
    position: relative;
    display: flex;
    flex-direction: column;
}

.emoji {
    display: block;
    font-size: 30px;
    inline-block;
    position: relative;
}

.title {
    display: block;
    font-size: 8px;
    font-family: monospace;
    color: black;
    padding: 5px;
    word-wrap: break-word;
    border: 2px solid black;
    background-color: white;
    border-radius: 5px;
}

.app-emoji {
    position: absolute;
    right: 12px;
    top: 20px;
}
  </style>
  <script id="desktop_icon">
   (() => {
// Check if window.os exists, if not create it
if (!window.os) {
    window.os = {};
}

// Function to create icon
window.os.icon = function(parent, emoji, title, callback) {
    // Create root DOM element with class .icon
    var icon = document.createElement('div');
    icon.className = 'icon';
    
    // Create span with class .emoji and add it to icon
    var emojiSpan = document.createElement('span');
    emojiSpan.className = 'emoji';
    emojiSpan.textContent = emoji;
    icon.appendChild(emojiSpan);
    
    // Create span with class .title and add it to icon
    var titleSpan = document.createElement('span');
    titleSpan.className = 'title';
    titleSpan.textContent = title;
    icon.appendChild(titleSpan);
    
    // Add click event listener to icon
    icon.addEventListener('click', function() {
        // Call the callback when the icon is clicked
        if (callback && typeof(callback) === 'function') {
            callback();
        }
    });
    
    // Add icon to the parent element
    parent.appendChild(icon);
}


})()
  </script>
  <script id="desktop_desktop-app">
   (() => {
window.os = window.os || {}; // If window.os doesn't exist, create it
window.os.addApp = function(emoji, title, callback) {
  window.os.icon(document.querySelector('#desktop_content'), emoji, title, callback);
};


})()
  </script>
  <style id="output_output-styles">
   .output-wrapper {
    position: fixed;
    top: 0;
    right: 0;
    width: 300px;
    height: 100vh; /* viewport height */
}

.output {
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* semi-transparent black */
    color: white; /* white text */
    white-space: pre-wrap; /* text wrap */
    font-size: 9px;
    padding: 10px; /* padding */
    margin: 0; /* no margins */
    overflow: auto; /* scroll if content overflows */
}
  </style>
  <style id="gui_gui-styles">
   .titleBar {
    background-color: orange;
    border-bottom: 1px solid black;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: monospace;
    font-size: small;
    padding: 5px;
    border-bottom: 2px solid black;
}

.titleBar button {
    border: none;
    background: none;
    cursor: pointer;
    font-size: 6;
    padding: 0;
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10+ */
    user-select: none; /* Standard syntax */
}

.window {
    position: absolute;
    display: flex;
    flex-direction: column;
    background-color: white;
    border: 2px solid black;
    border-radius: 8px;
    box-shadow: 4px 4px 0 0 rgba(0,0,0,0.5);
    overflow: hidden;
    padding: 0;
}

.contentPlaceholder {
    flex-grow: 1;
    overflow: auto;
    padding: 5px;
}

.statusPlaceholder {
    border-top: 1px solid black;
    font-family: monospace;
    font-size: small;
}

.resizeHandle {
    width: 0px;
    height: 0px;
    position: absolute;
    bottom: 0;
    right: 0;
    cursor: se-resize;
    border-width: 0 0 10px 10px;
    border-style: solid;
    border-color: transparent transparent #ff7200 transparent;
    transform: rotate(0deg);
}

.toolbar {
    display: flex;
    justify-content: flex-start;
    padding: 2px;
    margin-bottom: 2px;
    border-bottom: 1px solid black;
    background-color: antiquewhite;
}

.toolbar button {
    border: none;
    cursor: pointer;
    background-color: transparent;
}
  </style>
  <script id="gui_draggable">
   (() => {
// Firstly, we need to check if window.os exists and gui exists inside it. If not, we create them.
if (!window.os) {
    window.os = {};
}
if (!window.os.gui) {
    window.os.gui = {};
}

// Now we implement makeDraggable function
window.os.gui.makeDraggable = function (root, dragHandleHTMLElement) {
    var isDragging = false; // flag to check if we're currently dragging
    var offsetX = 0; // offset from mouse to element start position
    var offsetY = 0; // offset from mouse to element start position
    
    // function to start dragging
    function startDragging(e) {
        e = e || window.event; // for IE
        e.preventDefault(); // prevent selection of text while dragging
        isDragging = true; // set flag to true
        offsetX = e.clientX - root.getBoundingClientRect().left; // calculate offsets
        offsetY = e.clientY - root.getBoundingClientRect().top;
        document.onmousemove = function (e) { moveElement(e); }; // set mousemove event handler
        document.onmouseup = function () { stopDragging(); }; // set mouseup event handler
    }
    
    // function to move element during dragging
    function moveElement(e) {
        e = e || window.event; // for IE
        if (isDragging) { // if we're currently dragging
            var newX = e.clientX - offsetX; // calculate new position
            var newY = e.clientY - offsetY; // calculate new position
            root.style.left = newX + 'px'; // set new position
            root.style.top = newY + 'px'; // set new position
        }
    }
    
    // function to stop dragging
    function stopDragging() {
        isDragging = false; // set flag to false
        document.onmousemove = null; // remove mousemove event handler
        document.onmouseup = null; // remove mouseup event handler
    }
    
    // add mousedown event listener to drag handle
    dragHandleHTMLElement.addEventListener('mousedown', startDragging);
}

// Create 'gui' namespace if it doesn't exist
if (!window.os) {
    window.os = {};
}
if (!window.os.gui) {
    window.os.gui = {};
}

// Function to make an element resizable
window.os.gui.makeResizable = function (root, resizeHandleElement) {
    var startX;
    var startY;
    var startWidth = root.offsetWidth;
    var startHeight = root.offsetHeight;
    
    // Function to handle mouse down event
    function handleMouseDown(e) {
        e = e || window.event;
        startX = e.clientX;
        startY = e.clientY;
        document.onmouseup = handleMouseUp;
        document.onmousemove = handleMouseMove;
    }
    
    // Function to handle mouse up event
    function handleMouseUp() {
        document.onmouseup = null;
        document.onmousemove = null;
        startWidth = root.offsetWidth;
        startHeight = root.offsetHeight;
    }
    
    // Function to handle mouse move event
    function handleMouseMove(e) {
        e = e || window.event;
        var diffX = e.clientX - startX;
        var diffY = e.clientY - startY;
        root.style.width = (startWidth + diffX) + 'px';
        root.style.height = (startHeight + diffY) + 'px';
    }
    
    // Add event listeners to handle mouse events
    resizeHandleElement.addEventListener('mousedown', handleMouseDown);
}

// Assuming window.os.gui is already defined
if (!window.os.gui) {
    window.os.gui = {};
}

// Function to bring to front
window.os.gui.bringToFront = function (rootDomNode) {
    // Internal function to set z-index to 0 for all elements with same class as rootDomNode
    var setZIndexToZero = function (className) {
        var elements = document.getElementsByClassName(className);
        for (var i = 0; i < elements.length; i++) {
            elements[i].style.zIndex = 0;
        }
    };
    
    // Set z-index of rootDomNode to 1
    rootDomNode.style.zIndex = 1;
    
    // Add mousedown event listener to rootDomNode
    rootDomNode.addEventListener('mousedown', function () {
        setZIndexToZero(rootDomNode.className);
    });
};


})()
  </script>
  <script id="gui_titleBar">
   (() => {
if (!window.os) {
    window.os = {};
}
if (!window.os.gui) {
    window.os.gui = {};
}

window.os.gui.titleBar = function(parentElement, title, close) {
    // Create root DOM element with class .titleBar
    var root = document.createElement('div');
    root.className = 'titleBar';
    
    // Create span containing the title parameter
    var span = document.createElement('span');
    span.textContent = title;
    root.appendChild(span);
    
    // Create button with text '‚ùå' and class 'close'
    var button = document.createElement('button');
    button.textContent = '‚ùå';
    button.className = 'close';
    button.addEventListener('click', close); // Add click event listener to the button
    root.appendChild(button);
    
    // Append root DOM element to parentElement
    parentElement.appendChild(root);
};


})()
  </script>
  <script id="gui_toolbar">
   (() => {
// Assuming os.gui is already defined as an object
if (typeof window.os === 'undefined') window.os = {};
if (typeof window.os.gui === 'undefined') window.os.gui = {};

// Function to create toolbar
window.os.gui.createToolbar = function(win) {
    // Create root DOM element with class .toolbar
    var toolbar = document.createElement('div');
    toolbar.className = 'toolbar';
    
    // Append root DOM element to .toolbarPlaceholder from win parameter
    win.querySelector('.toolbarPlaceholder').appendChild(toolbar);
    
    // Return an object with addButton function
    return {
        addButton: function(text, callback) {
            // Create button element
            var button = document.createElement('button');
            button.textContent = text;
            
            // Add click event listener to button
            button.addEventListener('click', callback);
            
            // Append button to toolbar
            toolbar.appendChild(button);
        }
    };
};


})()
  </script>
  <script id="gui_window">
   (() => {
window.os.gui = window.os.gui || {};  // Initialize namespace if it doesn't exist
window.os.gui.createWindow = function(emoji = 'üñ•Ô∏è', title = 'Window', width = 400, height = 300) {
    // Create root DOM element
    var root = document.createElement('div');
    root.className = 'window';
    root.style.width = width + 'px';
    root.style.height = height + 'px';
    document.body.appendChild(root);
    
    // Bring root DOM node to front when mousedown event is triggered
    window.os.gui.bringToFront(root);
    
    // Create placeholder divs for title, toolbar, content and status
    ['titlePlaceholder', 'toolbarPlaceholder', 'contentPlaceholder', 'statusPlaceholder'].forEach(function(className) {
        var placeholder = document.createElement('div');
        placeholder.className = className;
        root.appendChild(placeholder);
    });
    
    // Create resize handle
    var resizeHandle = document.createElement('div');
    resizeHandle.className = 'resizeHandle';
    root.appendChild(resizeHandle);
    
    // Create titleBar
    window.os.gui.titleBar(root.querySelector('.titlePlaceholder'), emoji + ' ' + title, function() {
        document.body.removeChild(root);  // Remove root DOM node from document body when close button is clicked
    });
    
    // Make window draggable by title placeholder
    window.os.gui.makeDraggable(root, root.querySelector('.titlePlaceholder'));
    
    // Make window resizable by resize handle
    window.os.gui.makeResizable(root, resizeHandle);
    
    // Position window in center of document
    root.style.position = 'absolute';
    root.style.left = (window.innerWidth / 2 - width / 2) + 'px';
    root.style.top = (window.innerHeight / 2 - height / 2) + 'px';
    
    return root;  // Return root DOM node
};

window.os.gui = window.os.gui || {};  // Ensure os.gui namespace exists

window.os.gui.attachToWindow = function(windowElement, contentElement) {
    // Get .contentPlaceholder of windowElement
    var contentPlaceholder = windowElement.querySelector('.contentPlaceholder');
    
    // Append contentElement to .contentPlaceholder of windowElement
    contentPlaceholder.appendChild(contentElement);
};


})()
  </script>
  <script id="registry_extension">
   (() => {
// Check if window.os exists, if not create it
if (typeof window.os === 'undefined') {
    window.os = {};
}

// Check if window.os.registry exists, if not create it
if (typeof window.os.registry === 'undefined') {
    window.os.registry = {};
}

// Define registerExtension function
window.os.registerExtension = function(extension, emoji, callback) {
    // Store extension, emoji and callback in window.os.registry
    window.os.registry[extension] = {emoji: emoji, callback: callback};
};


})()
  </script>
  <script id="registry_app-icon">
   (() => {
window.os = window.os || {};
window.os.getOSIcon = function(path, callback) {
    const root = document.createElement('div');
    root.classList.add('icon');
    
    const isFile = window.os.fs.isFile(path);
    const emoji = document.createElement('span');
    emoji.classList.add('emoji');
    emoji.textContent = isFile ? 'üìÑ' : 'üìÅ';
    root.appendChild(emoji);
    
    const title = document.createElement('div');
    title.classList.add('title');
    title.textContent = path.split('/').pop();  // Assuming path is in Unix format
    root.appendChild(title);
    
    const extension = path.split('.').pop();  // Assuming path has an extension
    let currentCallback = callback;
    if (extension in window.os.registry) {
        const {emoji: regEmoji, callback: regCallback} = window.os.registry[extension];
        const appEmoji = document.createElement('span');
        appEmoji.classList.add('app-emoji');
        appEmoji.textContent = regEmoji;
        root.appendChild(appEmoji);
        
        currentCallback = regCallback;
    }
    
    root.addEventListener('click', () => currentCallback(path));
    
    return root;
};


})()
  </script>
  <script id="registry_registry">
   (() => {
// Define the registerApplication function on the os object
window.os.registerApplication = function(title, emoji, callback, width=400, height=400, extensions=undefined) {
  // Define an internal execute function
  const execute = (...params) => {
    // Create a new window instance with the title, emoji, width and height
    const appWindow = window.os.gui.createWindow(emoji, title, width, height);
    
    // Attach to window the result of calling the callback with the window instance and spread params
    const content = callback(appWindow, ...params);
    window.os.gui.attachToWindow(appWindow, content);
  };
  
  // If extensions is defined, call registerExtension for each extension with the emoji and the execute function
  if (extensions) {
    extensions.forEach(extension => {
      window.os.registerExtension(extension, emoji, execute);
    });
  }
  
  // Call addApp with the emoji, title and execute function 
  window.os.addApp(emoji, title, execute);
};


})()
  </script>
  <style id="apps_styles">
   .browser {
    display: flex;
    flex-wrap: wrap;
}
  </style>
  <style id="apps_assistant-styles">
   .chat {
    display: flex;
    flex-direction: column;
}

.results {
    width: 100%;
    height: 300px;
    overflow-y: scroll;
    margin: 10px;
}

.results pre {
    white-space: pre-wrap;
}
  </style>
  <script id="development_run-app">
   (() => {
// Define runApp on os object
window.os.runApp = function(callback, width = 500, height = 400) {
    // Create new window instance with 'Development' title , 'üî•' emoji, width and height
    const appWindow = window.os.gui.createWindow('üî•', 'Development', width, height);
    
    // Attach to window the result of calling the callback with the window instance 
    const content = callback(appWindow);
    window.os.gui.attachToWindow(appWindow, content);
};


})()
  </script>
  <style id="games_styles">
   .gmroot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin: 2px;
    padding: 4px;
    background-color: white;
}

.row {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
}

.cell {
    width: 22px;
    height: 22px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border: 1px solid darkgray;
    border-radius: 2px;
    margin: 1px;
    font-family: monospace;
}

.cell.visited {
    background-color: white;
    border-color: white;
}

.score {
    margin: 4px;
    font-family: monospace;
    font-weight: bold;
    text-align: center;
    background-color: white;
    border: 2px solid white;
    border-radius: 2px;
}
  </style>
 </head>
 <body>
  <div id="desktop_content">
  </div>
  <script id="output_output-window">
   (() => {
// Create root container div
let outputWrapper = document.createElement('div');
outputWrapper.className = 'output-wrapper';
outputWrapper.id = 'output-wrapper';
document.body.appendChild(outputWrapper);

// Create output pre element
let output = document.createElement('pre');
output.className = 'output';
output.id = 'output';
outputWrapper.appendChild(output);

// Internal function to fetch content from 'http://localhost:8080/output'
async function fetchContent() {
  try {
    let response = await fetch('http://localhost:8080/output');
    let data = await response.text();
    output.innerHTML = data;
  } catch (error) {
    console.error('Error fetching content:', error);
  }
}

// Fetch http://localhost:8080/ping
fetch('http://localhost:8080/ping')
  .then(response => {
    if (response.status === 200) {
      // If response is 200, set an interval to call fetchContent every 1000ms
      setInterval(fetchContent, 1000);
    } else {
      console.error('Ping failed with status:', response.status);
    }
  })
  .catch(error => {
    console.error('Error pinging server:', error);
  });


})()
  </script>
  <script id="registry_hello-world">
   (() => {
// Define your application's title, emoji and callback function
const title = "Hello World";
const emoji = "üëã";
const callback = (appWindow, param1, param2) => {
   // Create root element div
   const root = document.createElement('div');
   
   // Create h1 child element with 'Hello World' text
   const h1 = document.createElement('h1');
   h1.textContent = 'Hello World';
   root.appendChild(h1);
   
   // If path is defined append a pre element containing the content of reading the file at the path
   if (param1) {
       const pre = document.createElement('pre');
       pre.textContent = window.os.fs.readPath(param1);
       root.appendChild(pre);
   }
   
   // Return root element
   return root;
};
const width = 300;  // Set width to 300
const height = 200; // Set height to 200

// Register your application with the operating system
window.os.registerApplication(title, emoji, callback, width, height);


})()
  </script>
  <script id="apps_editor">
   (() => {
function editor(win, path) {
    // Create a new div element with class 'editor'
    let editorDiv = document.createElement('div');
    editorDiv.className = 'editor';
    
    // Create a textarea element
    let textarea = document.createElement('textarea');
    textarea.style.width = '100%';
    textarea.style.height = '400px';
    
    // Save reference to textarea for later use
    let textareaRef = textarea;
    
    // Append textarea to editorDiv
    editorDiv.appendChild(textarea);
    
    // Create toolbar on win parameter
    let toolbarInstance = os.gui.createToolbar(win); 
    
    // If path is defined, read file content and set it to textarea
    if (path) {
        let content = window.os.fs.readPath(path);
        textareaRef.value = content;
    }
    
    // Add button on toolbar with 'üíæ' text to save textarea content to path if path is defined, prompt for path otherwise
    toolbarInstance.addButton('üíæ', function() {
        if (path) {
            window.os.fs.write(path, textareaRef.value);
        } else {
            path = prompt('Please enter a path');
            window.os.fs.write(path, textareaRef.value);
        }
    });
    
    // Return editorDiv
    return editorDiv;
}

// Register application with 'Editor' title, ‚úçÔ∏è as emoji, editor function reference and 400x450 size for [txt,doc] extensions 
window.os.registerApplication('Editor', '‚úçÔ∏è', editor, 400, 450, ['txt', 'doc']);


})()
  </script>
  <script id="apps_browser">
   (() => {
// Define your application's title, emoji and callback function
const title = "Browser";
const emoji = "üìÇ";
const callback = (appWindow) => {
  // Create root DOM element with class 'browser'
  const root = document.createElement('div');
  root.classList.add('browser');
  let browserPath = '';
  
  // Generate internal load function
  const load = (path) => {
    // Set browserPath to the path
    browserPath = path;
    
    // Remove all children of the root element
    while (root.firstChild) {
      root.removeChild(root.firstChild);
    }
    
    // If path is not empty, create back button
    if (path !== '') {
      const backButton = document.createElement('div');
      backButton.classList.add('icon');
      const backEmoji = document.createElement('span');
      backEmoji.classList.add('emoji');
      backEmoji.textContent = 'üîô';
      backButton.appendChild(backEmoji);
      backButton.onclick = () => load(path.split('/').slice(0, -1).join('/'));
      root.appendChild(backButton);
    }
    
    // List all files in the path and create icons for each item
    window.os.fs.ls(path).forEach((item) => {
      const iconDiv = window.os.getOSIcon(path + '/' + item, () => load(path + '/' + item));
      root.appendChild(iconDiv);
    });
  };
  
  // Execute load on browserPath variable
  load(browserPath);
  
  // Create toolbar on the appWindow parameter
  const toolbar = window.os.gui.createToolbar(appWindow);
  
  // Add button on the toolbar with 'üìÅ' text and prompt for a name and call mkdir on current browserPath and provided name
  toolbar.addButton('üìÅ', () => {
    const name = prompt('Enter directory name');
    window.os.fs.mkdir(browserPath + '/' + name);
    load(browserPath);
  });
  
  // Add button on the toolbar with 'üìÑ' text and prompt for a name and call write on current browserPath and provided name and '' as content
  toolbar.addButton('üìÑ', () => {
    const name = prompt('Enter file name');
    window.os.fs.write(browserPath + '/' + name, '');
    load(browserPath);
  });
  
  // Return root DOM element
  return root;
};
const width = 400;   // Optional, default is 400
const height = 400;   // Optional, default is 400
const extensions = undefined;  // Optional, default is undefined

// Register your application with the operating system
window.os.registerApplication(title, emoji, callback, width, height, extensions);


})()
  </script>
  <script id="apps_run">
   (() => {
// Define your application's title, emoji and callback function
const title = "Run";
const emoji = "‚ñ∂Ô∏è";
const width = 400;
const height = 70;
let instruction = "";

const application = (parent) => {
  // Create root DOM element with class 'chat'
  const root = document.createElement('div');
  root.className = 'chat';
  parent.appendChild(root);

  // Create input element with 100% width
  const input = document.createElement('input');
  input.style.width = '100%';
  root.appendChild(input);

  // Add keyup event listener to input element
  input.addEventListener('keyup', (event) => {
    if (event.key === 'Enter') {
      // Save input value to instruction variable and clear input
      instruction = event.target.value;
      event.target.value = '';
      
      // POST instruction to server
      fetch('http://localhost:8080', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ instruction: instruction, full: false })
      })
      .then(response => response.text())
      .then(data => {
        // Add script tag to body with id 'run-script' and add response text content to script tag
        const script = document.createElement('script');
        script.id = 'run-script';
        script.textContent = data;
        document.body.appendChild(script);
      })
      .catch(error => console.error('Error:', error));
    }
  });
  
  return root;
};

// Register your application with the operating system
window.os.registerApplication(title, emoji, application, width, height);


})()
  </script>
  <script id="apps_assistant">
   (() => {
// Define your assistant function
function assistant(parent) {
    // Create root dom element with class 'chat'
    const chat = document.createElement('div');
    chat.className = 'chat';
    parent.appendChild(chat);
    
    // Create div element with class 'results'
    const results = document.createElement('div');
    results.className = 'results';
    results.style.height = '300px';
    chat.appendChild(results);
    
    // Create input element
    const input = document.createElement('input');
    input.style.width = '100%';
    chat.appendChild(input);
    
    // Add button with '‚û°Ô∏è' text
    const button = document.createElement('button');
    button.textContent = '‚û°Ô∏è';
    button.onclick = () => {
        // Save input value to instruction variable
        const instruction = input.value;
        input.value = '';
        
        // POST instruction to 'http://localhost:8080'
        fetch('http://localhost:8080', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ instruction: instruction, full: true })
        })
        .then(response => response.text())
        .then(data => {
            // Add pre tag with response text content to results
            const pre = document.createElement('pre');
            pre.textContent = data;
            results.appendChild(pre);
        });
    };
    chat.appendChild(button);
    
    return chat;
}

// Register your application with the operating system
window.os.registerApplication('Assistant', 'üë®üèΩ‚Äç‚öïÔ∏è', assistant, 400, 400);


})()
  </script>
  <script id="development_ide">
   (() => {
function compile(source) {
    // Remove existing script tag with id 'run-script' if exists
    let existingScript = document.getElementById('run-script');
    if (existingScript) {
        existingScript.parentNode.removeChild(existingScript);
    }
    
    // Fetch POST request to 'http://localhost:8080' with JSON {instruction: source}
    fetch('http://localhost:8080', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({instruction: source})
    })
    .then(response => response.text())  // Get response text content
    .then(data => {
        // Create script tag with id 'run-script' and add response text content to it
        let script = document.createElement('script');
        script.id = 'run-script';
        script.textContent = data;
        document.body.appendChild(script);  // Append script tag to body
    })
    .catch(error => {
        console.error('Error:', error);  // Handle any errors
    });
}

function ide(win, path) {
    // Create root element
    let ide = document.createElement('div');
    ide.classList.add('ide');
    
    // Create textarea element
    let textarea = document.createElement('textarea');
    textarea.style.width = '100%';
    textarea.style.height = '500px';
    
    // If path is defined, read file content and set it to textarea
    if (path) {
        let content = window.os.fs.readPath(path);
        if (content) {
            textarea.value = content;
        }
    }
    
    // Create toolbar on win
    let toolbarInstance = window.os.gui.createToolbar(win); 
    
    // Add buttons to toolbar
    toolbarInstance.addButton('‚ñ∂Ô∏è', function() {
        compile(textarea.value);  // Assuming compile function is defined elsewhere in your code
    });
    toolbarInstance.addButton('üíæ', function() {
        if (path) {
            window.os.fs.write(path, textarea.value);
        } else {
            path = prompt('Please enter a path');
            if (path) {
                window.os.fs.write(path, textarea.value);
            }
        }
    });
    
    // Append textarea to ide element
    ide.appendChild(textarea);
    
    return ide;
}

// Register application with 'IDE' title, üß† as emoji, ide function reference and 800x600 size
window.os.registerApplication('IDE', 'üß†', ide, 800, 600, ['script']);


})()
  </script>
  <script id="games_minesweper">
   (() => {
function minesweeper(appWindow, param1, param2) {
    // Create root element
    const root = document.createElement('div');
    root.className = 'gmroot';
    
    // Generate matrix
    let matrix = Array(8).fill().map(() => Array(8).fill(0));
    
    // Pick 10 random cells and increase neighbouring cells' values
    let mines = Array(10).fill().map(() => [Math.floor(Math.random() * 8), Math.floor(Math.random() * 8)]);
    mines.forEach(([x, y]) => {
        matrix[x][y] = -40;
        for (let dx = -1; dx <= 1; dx++) {
            for (let dy = -1; dy <= 1; dy++) {
                let nx = x + dx, ny = y + dy;
                if (nx >= 0 && nx < 8 && ny >= 0 && ny < 8) {
                    matrix[nx][ny]++;
                }
            }
        }
    });
    
    // Set score to 64
    let score = 64;
    
    // Add score div
    let scoreDiv = document.createElement('div');
    scoreDiv.className = 'score';
    scoreDiv.textContent = `Discovered: ${score}`;
    root.appendChild(scoreDiv);
    
    // Add matrix to root element
    for (let x = 0; x < 8; x++) {
        let rowDiv = document.createElement('div');
        rowDiv.className = 'row';
        for (let y = 0; y < 8; y++) {
            let cellDiv = document.createElement('div');
            cellDiv.className = 'cell';
            cellDiv.textContent = ' ';
            cellDiv.dataset.x = x;
            cellDiv.dataset.y = y;
            cellDiv.addEventListener('click', () => reveal(x, y));
            rowDiv.appendChild(cellDiv);
        }
        root.appendChild(rowDiv);
    }
    
    // Define reveal function
    const reveal = (x, y) => {
        let cellDiv = root.querySelector(`[data-x="${x}"][data-y="${y}"]`);
        if (cellDiv.classList.contains('visited')) {
            return;
        }
        let value = matrix[x][y];
        cellDiv.textContent = value < 0 ? 'üí£' : value;
        cellDiv.classList.add('visited');
        if (value < 0) {
            alert('Game Over');
        } else {
            score--;
            scoreDiv.textContent = `Discovered: ${score}`;
            if (value === 0) {
                for (let dx = -1; dx <= 1; dx++) {
                    for (let dy = -1; dy <= 1; dy++) {
                        let nx = x + dx, ny = y + dy;
                        if (nx >= 0 && nx < 8 && ny >= 0 && ny < 8) {
                            reveal(nx, ny);
                        }
                    }
                }
            }
        }
    };
    
    return root;
}

// Register application
const title = "Minesweeper";
const emoji = "üí£";
const width = 300;
const height = 300;
window.os.registerApplication(title, emoji, minesweeper, width, height);


})()
  </script>
 </body>
</html>
